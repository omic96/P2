<!DOCTYPE html>
<html>

<head>
    <title>hej</title>
    <meta charset="UTF-8">
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <button>Rate a movie</button>
    <script>

        let socket = io();
        socket.emit("get movielist");
        
        socket.on("send movielist", function(movielist) {
            rate_movie(movielist);
        });

        console.log(read_cookie("id"));

        function rate_movie(movies_to_rate){
            let rating = 0; 
            
            for (let index = 0; index < movies_to_rate.length; index++) {
                console.log(movies_to_rate[index].title);
                //movies_to_rate[index].rating 
                rating = prompt("Rate "+ movies_to_rate[index].title + " from 1-5");  //tilfÃ¸jer rating til objekterne 

                //input control 
                while(isNaN(rating) || rating > 5 || rating < 1){
                        rating = prompt(rating + " is not between 1-5. Please try to rate "+ movies_to_rate[index].title + " from 1-5");
                    }
                
                    movies_to_rate[index].rating = rating;
            }
            socket.emit("send rated movies", movies_to_rate, read_cookie("id"));
            location.href="frontpage.html";
        }

        function read_cookie(name) {
            var value = "; " + document.cookie;
            var parts = value.split("; " + name + "=");
            if (parts.length == 2) return parts.pop().split(";").shift();
        }
    </script>
</body>
</html>