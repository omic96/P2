<html>
    <head>
        <title>Movie Recommender</title>
        <link rel="stylesheet" type="text/css" href="css/mainStyleSheet.css">
        <script src="/socket.io/socket.io.js"></script>
    </head>

    <body>
        <center class="login_page_text">
        <h1>P2 Movie Recommender 2020</h1>
        <h3>Login</h3> 
        Username: <input type="input" id="username_login">
        Password: <input type="password" id="password_login">
                  <input type="button" id="loign_button" value="Login" onclick="login()">
        <br>

        <h3>Register</h3>
        Username: <input type="input" id="username_register">
        Password: <input type="password" id="password_register">
                  <input type="button" id="register_button" value="Register" onclick="register()">

        </center>
        <script>
            let socket = io();

            socket.on('login success', function(first_time_logged_in, user_id) {
                document.cookie = "id=" + user_id + "; expires=Thu, 18 Dec 2030 12:00:00 UTC path=/";
                if(first_time_logged_in == false)  {
                    location.href = "frontpage.html";
                }else{
                    location.href = "ratemovies.html";
                }
            });

            socket.on('login failed', function(){
                alert("Incorrect username or password!");
            });

            socket.on('register success', function() {
                alert("Your user has been created!");
            });

            socket.on('register failed', function() {
                alert("This username is already taken!");
            });

            
            function login () {
                let user_info = {
                    name : document.getElementById("username_login").value,
                    pass : document.getElementById("password_login").value
                }

                socket.emit('login',user_info);
            }


            function register() {
                let user_info = {
                    name : document.getElementById("username_register").value,
                    pass : document.getElementById("password_register").value
                }
                socket.emit('register', user_info)
            }
        </script>

    </body>
</html>